# 🔄 실시간 협업 스프레드시트

Next.js, WebSocket, Yjs를 사용한 실시간 협업 스프레드시트 데모입니다.

## 🚀 기술 스택

- **Next.js 16** - React 프레임워크
- **Yjs** - CRDT 기반 실시간 협업 라이브러리
- **Socket.io** - WebSocket 실시간 통신
- **TypeScript** - 타입 안정성
- **Tailwind CSS** - 스타일링

## 📋 기능

- ✅ 실시간 다중 사용자 동시 편집
- ✅ 충돌 없는 데이터 동기화 (CRDT)
- ✅ WebSocket을 통한 빠른 통신
- ✅ 20x10 스프레드시트 그리드
- ✅ 연결 상태 표시
- ✅ **사용자별 색상 구분** - 각 사용자에게 고유한 색상 할당
- ✅ **실시간 편집 중 표시** - 다른 사용자가 편집 중인 셀을 실시간으로 표시
- ✅ **사용자 Awareness** - 누가 어떤 셀을 편집하고 있는지 실시간 확인

## 🛠️ 설치 및 실행

### 1. 의존성 설치

```bash
npm install
```

### 2. 개발 서버 실행

```bash
npm run dev
```

### 3. 브라우저에서 열기

여러 브라우저 탭이나 창에서 동시에 접속하세요:

```
http://localhost:3000
```

## 🔍 작동 원리

### Yjs (CRDT)

- **Conflict-free Replicated Data Type**을 사용하여 충돌 없이 데이터를 동기화합니다
- 네트워크가 불안정하거나 오프라인 상태에서도 작동합니다
- 각 클라이언트가 로컬에서 편집하고, 변경사항이 자동으로 병합됩니다

### WebSocket (Socket.io)

- 실시간 양방향 통신을 제공합니다
- 서버가 모든 클라이언트 간의 업데이트를 중계합니다
- 연결이 끊어지면 자동으로 재연결을 시도합니다

### 아키텍처

```
[클라이언트 A] ←→ [WebSocket 서버] ←→ [클라이언트 B]
      ↓                    ↓                    ↓
   Yjs Doc            Yjs Doc (메모리)       Yjs Doc
```

## 📂 프로젝트 구조

```
websoket-demo/
├── app/
│   ├── components/
│   │   └── CollaborativeSpreadsheet.tsx  # 스프레드시트 컴포넌트
│   ├── page.tsx                           # 메인 페이지
│   └── layout.tsx                         # 레이아웃
├── server.js                              # 커스텀 서버 (Socket.io + Next.js)
└── package.json
```

## 🎯 테스트 방법

1. 여러 브라우저 탭을 열어서 `http://localhost:3000` 접속
2. 각 탭에서 셀을 동시에 편집
3. 변경사항이 모든 탭에 실시간으로 반영되는 것을 확인

## 🔧 커스터마이징

### 그리드 크기 변경

`app/components/CollaborativeSpreadsheet.tsx`에서 상수를 수정하세요:

```typescript
const ROWS = 20; // 행 개수
const COLS = 10; // 열 개수
```

### 문서 ID 변경

여러 독립적인 스프레드시트를 만들려면:

```typescript
const documentId = 'your-unique-document-id';
```

## 🎨 주요 기능 상세

### 실시간 사용자 Awareness

- **편집 중 표시**: 다른 사용자가 편집 중인 셀은 해당 사용자의 색상으로 하이라이트됩니다
- **사용자 이름 표시**: 편집 중인 셀 위에 사용자 이름이 표시됩니다
- **색상 구분**: 각 사용자는 10가지 색상 중 하나를 랜덤으로 할당받습니다
- **실시간 업데이트**: 사용자가 셀을 포커스하거나 해제하면 즉시 다른 사용자에게 전달됩니다

### Yjs CRDT의 장점

- **자동 충돌 해결**: 여러 사용자가 동시에 편집해도 데이터 일관성 유지
- **오프라인 지원**: 네트워크가 끊겨도 로컬에서 작업 가능
- **효율적인 동기화**: 변경된 부분만 전송하여 대역폭 최소화

## 📝 다음 단계

이 데모를 확장할 수 있는 방법:

- 📊 셀 포맷팅 (굵게, 색상 등)
- 🧮 수식 계산 지원
- 💾 데이터베이스에 영구 저장
- 📱 모바일 반응형 디자인
- 🔐 인증 및 권한 관리
- 📤 내보내기/가져오기 기능 (CSV, Excel)
- 👥 사용자 프로필 및 아바타
- 💬 채팅 기능

## 🐛 문제 해결

### 연결이 안 되는 경우

1. 서버가 실행 중인지 확인: `http://localhost:3000`
2. 방화벽이 포트 3000을 차단하지 않는지 확인
3. 브라우저 콘솔에서 에러 메시지 확인

### 동기화가 안 되는 경우

1. 브라우저 콘솔에서 "Connected to server" 메시지 확인
2. 페이지를 새로고침하여 재연결 시도
3. 서버 로그에서 에러 확인

## 📚 참고 자료

- [Yjs 공식 문서](https://docs.yjs.dev/)
- [Socket.io 공식 문서](https://socket.io/docs/v4/)
- [Next.js 공식 문서](https://nextjs.org/docs)

## 📄 라이선스

MIT
